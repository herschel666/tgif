language: python
python:
  - '3.6'

branches:
  only:
    - master

cache:
  pip: true
  npm: true
  directories:
    - .venv

env:
  global:
    - STAGE=prod
    - SAM_CLI_TELEMETRY=0
    - secure: 'b4G1Vv/KLkiw3dtgB8Lmy6idvoQWBkOyEYuCGW4n4frc/mEszLc/ruZ9qx1u2dNY7Rd6iGqXJhuqi6epIPZ6FfcI2s/Xe30Rz02sMSZEnPnfwMgrT3Oz08G9l489pQSkSILjrPSzZJ/pd+jN2GcwFfYRe1gXwQXlFSdUBay9eKv8QLpA6w0B3u90hrSzB3B+sHLZ1RkFA/H696ylbvfkvpDsgGxu8aebBQqftlDnpuVLlofSu8aF2jOkfVpnR9h0pAh1xBFh69TPsKDpUZCj3J0ezlmESwcd5Hd1zwQAtxZPmkKZyhW9OsP3vNKwHNK7HDAGu9DzGsvPmfN1MQsHJVTl9KfLkNO9to8oUlMwatXZqh7kedgcDFzQG165nAHKvUEI7MamEFJzdwS12hZwLLT5XSmnGO1Er76BkWcZ1JIZLlGnvG8PdIqia8Lveu+IZ1dYkbjNf/NDZXFdXuAbyHT+9b16bHHUw4Dc5l72LDcZ1b6LiZ5FFxS3kZOHar60F637JkIzkHKj4JQosgU5tYimroME95hyhiMZGcSudO5f/tfOYgU25lytYL1KY0tLvpiQmyJkqNbPprXv3BPOYrSZHfPT/8E62EiHURmA+dyPYsh7sCE6Fw1Rt1woU2ldQ/usW+o8BtnMbT8L3aLO+qOi18K2T04NGXRaH7rhfY0='
    - secure: 'GeC5tb7PRYC0u/IsnGEBH0vbafYwLzdmeoKOCNPLX0y6rgucCghw1qw5MLEO8XeWeXoHHAhAA95QAeVF8EogN2nZF53XWLZJepn782LtJKwjCVnq+Xi5vpDRQeWN++x8JomzDsHYrDPQiLKVRKAPzCX14bIvYaq6lCwXPp/s61nP5j3tnVcvSoRf4Yjby/qc3UFDrNykIE0+Fy/VGirYK9FfE/hn8CkYOhQX0dzK5CKuUwiPD72soKVezA3ZggyLB83FDJvBJK4R2p8khCgt6uH904iRGyQsSIonO4yRcOp1/r8MxIHj1KNVoQD8o+mEewIDfQe8vlStE4n8KIteqRbcFD8Qc9D+h9efNNV6AH8uj6fRrj+a+mgMeZkqIF+Y511NIGHfQ4e4XlHJz0tlsG5d/jyZPlFZikFfUN9qM0bv/Ezd5kzmt8dAj0VuScnhZt0Ju7Gtksdy4T5eY2PTqIJbKqecUYjwQgLcUCYIiActlQWdynS45ytTd/t/1nPKeocxERhKfS78tW28WrS/SX2Cpp2bO6Ihw5ksIjCvyYI7qXpd5DR7kXf+SAtcGg/R1GSnJSFrskhbQ5xqkBSgPOTGr9pvCcDA4b5HICIUGs33X58rXXPIUDbOgfz2t6ST1jX8wI1CA0uckNfu4mSHBUPBMl8IT7I34Asv4IdrL20='
    - secure: 'FrsoU2VlPY3GN0yTmHY+YL/C6XduDWqCqMjphTbYS+GZjwKk8gkMZIgvd2DBzFpxeYnPmcWOBr40ucV8DcOsG0X23lPJl7Sj+tYho1fI9hVngKhefJvgrhKszp/lAh1ujIeZuAYs/jnm8u+SxeFW0yb1ZUf3X6Fx0E9CpKKy/x98yJZa3FWXJTSXoPBxZyueHA0yZyznDXoenUw9sclWGeNCuXrCdLQHdrXckt6I1g9ad1jpfmZy95MWesZj1cLEsGPXmL1I2KX2emCTN8MDguDmgoW5AbARiFO3r68V/1w3KRj73rEYZpsHQjeoPwkVSrog9Y97orGu0xaSx7DmYrlhjRwue0KcK+9R8iukq2zSYaw7XoYQ/oL0NKInoDSy2fxKJBkHUU42gufenq4wnPhcx4yNKxfOWXvjJIuMWS92o4QLjteANrNd5j+XOG7MuI8iMlnG/mXy9zsblcaGQmhW0f/eNxW2Crg3v85IcywpKqmA1eK/wVH8stEgPiMtST4qqY631bMbp26ccitrdYnJsQeg0R+GS5olWFC02ajck4x8PYMgtDKoHP1D/4GAXd+O2dxhUPuBEdU2+U+0mi1wAVoJaaIW7BJOfjD+Pos5BTBaua6RUw3pnIv2vdaYVRcXL9qm/fDNvVdFLpiYrD4JdaSWDcBUipBSY84zkvs='
    - secure: 'nC2wOoMkKCLH6m4liKA1+8U//T2Z8Fcatgdy+Am9rMEmEts3ktPIXnrp7QcRib3O+Vh2c2/Rx6hrV2F4qIRuCyxRl3apJ0guzKGnaIAlwxaYQg/4DxCaGNmi3qu2jGJ7fIfkqGbaA/zNILCOCavXmcoBfY0DWtnoHxBSrb6AVytnX1wZFujlvrs/xZ50T2NAmlyLK9KdMWqe7/gR3isl3Yt2cKHSvSmTcYmWfPg+fZRKnU4grAfVaKuNIpykqM/podJbQ31VkPOjLceSSVImxmRxL0JF2eMgPqBlloTvbKYAWDQJsJwR7W/hiyNo/QZyoCQZxuhNaytuRVspMdlk9x2NYJASsV5MenAQnoZArc59kXpcktRSS8MZgmKMbhDIm2sp+4biANceyxrOuWn8tM0U43zQesb48Cht5QW9BOJMoyZHiOYBVll3pQyOVO9MpZjgI/uyQoqsS4YZcw9Gu3tp3TX8VLDK6I7M3NjqG+ox5zV1Iu16SlXg7Sh1M3ardNGIsrMP+503bl/4LG/sVr585N9v8S0WSxIZA4eAvUUycq/S1xM9lQkof7uAjOVl6lmuWAnQoZz5lQvbWmE9qhAFK3OzjVGUo7ALAt5jVZu4pJ5aDsFnt7UtmYAT3MwX/+uY5ukyfoYMDwCux3IJUaTAU6gt4v8oinOOeKpwGeU='
    - secure: 'aM0djSVUMTsKt/KEX4XXf1tFZbG+eNsLGNY4+DhVQzIgFhUa/CXAA/IYEC06xTykEWMRNjVCMOydxg6ACqUowah+Dh6Y5296D9Ms7gz29jU54ZMde7tYFCr7pxRUEbOgydTp+Wnmq83d80Xc6oKzZIGRnV8P0IqnrgX3VSyI1wu5T+tuOtvG9BCAF/ea5AfcgggPHuAjqFNP1KsfJrKue+PCCSF5XjITQdaIkAdapSDvGzhh6PoaVsVIRi6Z5MgWzhXfNQMHHu9LPGAV2Vs0HJ8aaIf76X9Ve+f5Q+6C3b9c5WdOEcOMPCEyBmW5/V+kKe8EyB/7r2gGUUnBSWMDMglpGHJzF4ARk40GM0RzkyVUqYuZ03ya+CPLInRwp/rGDqHpEXInwASfQJSc8CWeMKHUIAoto/7H6wirR03LOqCFqcltbjz5hZwkJgircyouj9uA4W58GblP9SUtyKpVUufrzj3PPiUFYw0WrBM/kLV6CVzqG4mFcqy+dTpotDeNqFRLfdBo/0W/iGOTZ3gXkqF+/O3iGi3B3Qe7bx4xKOWtUTysuBnr2htGQSyhGEXoF2ZDazjlc2KYDhWMgzYfiiOyoONXsk6XG3PUNUNVJitCw38VEIjiIoNGm8s1mxNdB6Y3YpRZHoW9O1vG1mOZr7jvyxvv8hZc++xlhK52Ddc='
    - secure: 'cUCGNHG12do7ZCVCFNuKI0gJ1rdkH498tSWwGKM72fCPy91SkkKdPr1XFxgAnkFrrSoO253TpEIMkmWDiF3OOV73jRJ3eBTLplrtzZE/yG/zhEP5xgnIehgTdULOpgjgyJk+/GDDMfOQMX7+pQJOxmPwh8pwR3Tvd3Q8lVOlUISFrMtRiSf6w3hX1tP0m7opg9Wub2pKSBTU0Sd7EC/edFCu98/hG/Eg3cxSK5bm4wISjeVptzaTjaO9++2JX6wzTc3+THMouYT1EzwyVWK+e6hzQCrtMg7HFnU5WwuTckCDrMn8mGTX0y66oktoEyD1PlA6Y4/YIPMn1nm3izoZSBvzCMG8fWfhnxmZ7GyjrQbaiBq1yzeIByzUOqEggO7HhkNLFhRCe6iBmvUQ15a2b73nbOSAkgbeCBYxDm+RUeXQcfmqazwq7OASeHk5Q64XYzQlhBvwx8tYeT1GQGGuQ/ZAHS3gnOf9/2va6UbisX2RPwe6u58dPlXEpLPAVNvTSB7n5uPAd3XzYEOX2GSlH+AYwSMnmq+H7W753Ep5obfcohcctJq4nN+tLGTZ4/NArHcVefaYzF8QQ/bh8iELp4G3j4jvnBQK6IlG496eqzkDOXigHlyiB1TgtS0uySSR3cyphmnvwttXgd9jMu0LzHhqfGyumaQZhSFbBN7bLgM='
    - secure: 'edPgsU6VSu3gkweFrsdrJYv7zP607p5/pzedtGeMBwvJ5Ju0SpM6feAoHLaCrrGL+/esH7NT2HjRDcwXfBVVMmcKRe3wy2FyGXQRHev/9AgZrvIKB6cZCRBcYs5uE8OfIaMARzWphib6zyYHt6LEvJN0g0NT6pR/jH4FC4bDqVO80eCT0xlwXS4531B/MVS6+xPEddsrMCmFQE6b2QnOAvArChEY5b+cSen8wmK1prbsuCaDQRK9VRbZjpe5M4uzjx2TUd0CP1sSkmuvwSxDBd6bLVYJFhnTdwY2g/V0xRxC2tayTXpN43QuymuXeDA+5uBntpsczOYNxntPOHw9LTfuUgvmMqJWL4n4AaEqxDrKFlzAqhF7ApS+WMZ+vauVq9T9lsipAyYhCr2PsehqUl/iwiT4PmzxNLoFXwSNwS7RR/6zkTNwYI8xwyYq/iHGqGOog8kkWYim+PBf775Yy73ztZ86tS5uPkoY71xZH8hRrYV+zZUtLeLi7h9ch4kSlHcvf1FoTn/PHqi1zZ+GsfIajz/MPi95+vUreiU+gxAuFYAsswvy9m9sNKEZQmPCq6lVesSob8IxuDh8SDbtcRpaN4f8OmUP2v/XDPjAJtN3dhqNMGKCaNlhQG03zdb0birA1ZPnjxD8Fcbt9IFcRXZRLgYNGSHOf9IEpQ7FkjI='
    - secure: 'Hiu+5sTkbu+gGGPc42T7si88ha/f0tQWtAE6dbQ6elI0uVbVELcEv5+Iz8tRcPHLuUcs/gWCHgwkipm3dOfi/R0YNzT8dCQuKFJoecpm9dKNS4RgH5Z40OA2ej8UZ9sRzmJvCe0xh6OUZ5kKb5YldSAfqv6KNPYtPLn2Zy04hJCK8hcJBJB9DnXxWmsS6wLf77swWboCIe3V2WToj9ILrxPqvciB8L3zbE199WDar94rApNEs8wttENyYtWZsFrD9z5DXWRRZGMFn/KQSKx/CwW5eOQV04EeCPrS8pyE69XYHkXgeoKID0z1KyogFBve1Zsfi2Bpf5nIN5laKw/Bb8gvRovW4ed78x+FsxLjC0DOQdDT85DvDpOI1U8THEX6ki1AOcWc4cb/PTXQgWahrXlhaT2xB+gbJCO1otqtWhCqhHHsXCX0umvhnj7/vjLIqVUbLG0iwuMFt0ZrT4mrK8H2j4/U1dUSia9CzaufXeUit5t59FbA5b6bz5e4mcjeGG9ICEiB945co2jZmjr4UjeVfSDMt+XwCAr+EDtpSz9wITvTme0c9mexkBHOcaM4cGY+TiLFxX1B4UAWHvwuh+oi9C1ltbZ6Ges5SGGztOohk3uaD1yZRb20K1wXe+styokK1TM5sON+vnQA8abNLvexYwPC2kVmtqtClxwZWgo='

before_install: nvm install

install:
  - npm ci
  - npm run bootstrap

script: npm test

deploy:
  - provider: script
    script: make upload
    skip_cleanup: true
